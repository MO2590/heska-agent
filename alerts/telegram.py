"""\nTelegram Alert System and X (Twitter) Posting\nSends alerts to Telegram and posts findings to X\n"""\nimport requests\nimport logging\nimport tweepy\n\nlogger = logging.getLogger(__name__)\n\nclass TelegramBot:\n    """\n    Telegram bot for sending alerts and posting to X\n    """\n    \n    def __init__(self, token, chat_id, x_api_keys=None):\n        self.token = token\n        self.chat_id = chat_id\n        self.base_url = f"https://api.telegram.org/bot{token}"\n        \n        # X (Twitter) API setup\n        self.x_enabled = False\n        if x_api_keys and all(x_api_keys.values()):\n            try:\n                self.x_client = tweepy.Client(\n                    bearer_token=x_api_keys.get('bearer_token'),\n                    consumer_key=x_api_keys.get('api_key'),\n                    consumer_secret=x_api_keys.get('api_secret'),\n                    access_token=x_api_keys.get('access_token'),\n                    access_token_secret=x_api_keys.get('access_token_secret')\n                )\n                self.x_enabled = True\n                logger.info("✓ X (Twitter) posting enabled")\n            except Exception as e:\n                logger.error(f"X API setup failed: {e}")\n    \n    def send_alert(self, message):\n        """\n        Send alert to Telegram\n        """\n        try:\n            endpoint = f"{self.base_url}/sendMessage"\n            payload = {\n                "chat_id": self.chat_id,\n                "text": message,\n                "parse_mode": "Markdown"\n            }\n            \n            response = requests.post(endpoint, json=payload, timeout=10)\n            \n            if response.status_code == 200:\n                logger.info("Alert sent to Telegram")\n                return True\n            else:\n                logger.error(f"Telegram API error: {response.status_code}")\n                return False\n                \n        except requests.exceptions.RequestException as e:\n            logger.error(f"Telegram request failed: {e}")\n            return False\n    \n    def post_to_x(self, message):\n        """\n        Post message to X (Twitter)\n        """\n        if not self.x_enabled:\n            logger.warning("X posting is not enabled")\n            return False\n        \n        try:\n            # Clean message for X (remove Telegram Markdown if needed)\n            clean_message = message.replace('*', '').replace('_', '')\n            \n            # Post tweet\n            response = self.x_client.create_tweet(text=clean_message)\n            \n            if response.data:\n                tweet_id = response.data['id']\n                logger.info(f"✓ Posted to X: Tweet ID {tweet_id}")\n                return True\n            else:\n                logger.error("X post failed: No response data")\n                return False\n                \n        except Exception as e:\n            logger.error(f"X posting error: {e}")\n            return False\n    \n    def send_and_post(self, message, post_to_x=True):\n        """\n        Send to Telegram and optionally post to X\n        """\n        # Always send to Telegram\n        telegram_success = self.send_alert(message)\n        \n        # Post to X if enabled\n        x_success = False\n        if post_to_x and self.x_enabled:\n            x_success = self.post_to_x(message)\n        \n        return {\n            'telegram': telegram_success,\n            'x': x_success\n        }
